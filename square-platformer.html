<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Square platformer</title>
    <style>
        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            background-color: #90ee90;
            margin: 0;
            overflow: hidden;
        }
        canvas {
            border: 1px solid black;
            background: linear-gradient(to top, #87CEEB, #B0E0E6);
            box-shadow: 10px 10px 20px rgba(0, 0, 0, 0.5);
        }
        .menu, .game-over {
            position: absolute;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
        }
        button {
            font-size: 20px;
            padding: 10px;
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <div class="menu" id="menu">
        <h1>Square platformer</h1>
        <button onclick="startGame()">Play</button>
    </div>
    <div class="game-over" id="gameOver" style="display: none;">
        <h1>Game Over</h1>
        <p>Score: <span id="finalScore">0</span></p>
        <button onclick="startGame()">Restart</button>
    </div>
    <p>Score: <span id="score">0</span></p>
    <canvas id="gameCanvas" width="800" height="400"></canvas>
    <script>
        const canvas = document.getElementById("gameCanvas");
        const ctx = canvas.getContext("2d");
        const scoreDisplay = document.getElementById("score");
        const menu = document.getElementById("menu");
        const gameOverScreen = document.getElementById("gameOver");
        const finalScoreDisplay = document.getElementById("finalScore");

        let monkey;
        let platforms;
        let gameRunning = false;
        let keys = {};

        window.addEventListener("keydown", (e) => keys[e.key] = true);
        window.addEventListener("keyup", (e) => keys[e.key] = false);

        function startGame() {
            menu.style.display = "none";
            gameOverScreen.style.display = "none";
            gameRunning = true;
            resetGame();
            gameLoop();
        }

        function resetGame() {
            monkey = {
                x: 400,
                y: 300,
                width: 40,
                height: 40,
                velocityY: 0,
                velocityX: 0,
                speed: 3,
                gravity: 0.4,
                jumpPower: -10,
                onGround: false,
                score: 0
            };
            platforms = [{ x: 350, y: 350, width: 100, height: 20, speed: 0, direction: 1 }];
            for (let i = 0; i < 5; i++) {
                generatePlatform();
            }
        }

        function generatePlatform() {
            let lastPlatform = platforms[platforms.length - 1];
            let newY = lastPlatform.y - (90 + Math.random() * 40);
            let newX = lastPlatform.x + (Math.random() * 400 - 200);
            newX = Math.max(50, Math.min(canvas.width - 150, newX));
            let speed = Math.random() < 0.3 ? 1 + Math.random() * 2 : 0; 
            platforms.push({ x: newX, y: newY, width: 100, height: 20, speed: speed, direction: 1 });
        }

        function gameLoop() {
            if (!gameRunning) return;
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            monkey.velocityY += monkey.gravity;
            if (keys["ArrowLeft"]) monkey.velocityX = -monkey.speed;
            else if (keys["ArrowRight"]) monkey.velocityX = monkey.speed;
            else monkey.velocityX = 0;
            
            if (keys["ArrowUp"] && monkey.onGround) {
                monkey.velocityY = monkey.jumpPower;
                monkey.onGround = false;
            }
            
            monkey.x += monkey.velocityX;
            monkey.y += monkey.velocityY;
            
            let onPlatform = false;
            platforms.forEach((platform) => {
                platform.x += platform.speed * platform.direction;
                if (platform.x <= 0 || platform.x + platform.width >= canvas.width) {
                    platform.direction *= -1;
                }
                if (
                    monkey.y + monkey.height >= platform.y &&
                    monkey.y + monkey.height + monkey.velocityY >= platform.y &&
                    monkey.y + monkey.height - monkey.velocityY <= platform.y + 5 &&
                    monkey.x + monkey.width > platform.x &&
                    monkey.x < platform.x + platform.width
                ) {
                    monkey.y = platform.y - monkey.height;
                    monkey.velocityY = 0;
                    onPlatform = true;
                    monkey.x += platform.speed * platform.direction;
                }
            });
            monkey.onGround = onPlatform;

            if (monkey.y < canvas.height / 2) {
                platforms.forEach(p => p.y += 2.5);
                monkey.score++;
                scoreDisplay.innerText = monkey.score;
                if (platforms[0].y > canvas.height) {
                    platforms.shift();
                    generatePlatform();
                }
            }
            if (monkey.y > canvas.height) {
                endGame();
                return;
            }
            monkey.x = Math.max(0, Math.min(canvas.width - monkey.width, monkey.x));
            ctx.fillStyle = "#6AB04A";
            ctx.strokeStyle = "#0d3d15";
            ctx.lineWidth = 5;
            platforms.forEach((platform) => {
                ctx.beginPath();
            ctx.roundRect(platform.x, platform.y, platform.width, platform.height, 10);
            ctx.fill();
            ctx.shadowColor = 'rgba(0, 0, 0, 0.3)';
            ctx.shadowBlur = 20;
            ctx.shadowOffsetX = 8;
            ctx.shadowOffsetY = 8;
            ctx.strokeRect(platform.x, platform.y, platform.width, platform.height);
                ctx.shadowColor = "rgba(0, 0, 0, 0.5)";
                ctx.shadowBlur = 10;
            });
            ctx.fillStyle = "#D2691E";
            ctx.strokeStyle = "#5a2e1a";
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.roundRect(monkey.x, monkey.y, monkey.width, monkey.height, 10);
            ctx.fill();
            ctx.strokeRect(monkey.x, monkey.y, monkey.width, monkey.height);
            ctx.shadowColor = "rgba(0, 0, 0, 0.5)";
            ctx.shadowBlur = 10;
            requestAnimationFrame(gameLoop);
        }

        function endGame() {
            gameRunning = false;
            gameOverScreen.style.display = "flex";
            finalScoreDisplay.innerText = monkey.score;
        }
    </script>
</body>
</html>




